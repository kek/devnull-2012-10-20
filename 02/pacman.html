<html>
	<head>
		<title>Test</title>
		<!--  script src="lib/jquery-1.7.1.min.js"></script -->
		<script>
		
		
		//$(document).ready(function(){
			
			//alert("fisk => "+rev("fisk"));
			//alert("fisk2 => "+rev("fisk2"));
		//});
		
		</script>
	</head>
	<body>
	<div id="test"></div>
	<canvas id="myCanvas" width="320" height="240"></canvas>

	<br> <a href="#">Seed</a>
	<script src="http://www.google.com/jsapi"></script>
	<script>google.load("jquery", "1.3")</script>
	<script type="text/javascript" src="random.js"></script>
<script>
	
var tilesize = 20;
var map = [
"################",
"# ############ #",
"# ############ #",
"# ############ #",
"# ############ #",
"# ############ #",
"#              #",
"# ############ #",
"#              #",
"################",
];

function wallAt(x, y) {
	return map[y][x] === "#";
}

var c = document.querySelector("canvas");
var context = c.getContext("2d");

function draw() {

	pacman.draw();
}

function logic() {
	pacman.move();
}

var Pacman = function(){
	this.x=0;
	this.y=0;
	this.dx=0;
	this.dy=0;
	
	this.init = function(){
		for(var x=0; x<16; x++){
			for(var y=0; y<10; y++){
				if( !wallAt(x,y) ){
					this.x = x;
					this.y = y;
				}
			}
		}
		console.log("init pacman x=", this.x, " y=", this.y)
	}
	this.init();
	
	this.setDirection = function(dx, dy){
		this.dx=dx;
		this.dy=dy;
		console.log("set direction pacman dx=", this.dx, " dy=", this.dy)
	}
	
	this.draw = function(){
		context.fillStyle="#FFFF00";
		context.fillRect(this.x*tilesize,this.y*tilesize,tilesize,tilesize);
	}
	this.move = function(){
		if( !wallAt(this.x+this.dx, this.y+this.dy) ){
			this.x+=this.dx;
			this.y+=this.dy;
		}
	}
};

var pacman = new Pacman();


function loop(){
	setTimeout(function(){
		draw();
		logic();
		loop();
	},50);
}
loop();

$(document).keydown(function(e){
    if (e.keyCode == 37) { 
		pacman.setDirection(-1,0);
		return false;
    }
    if (e.keyCode == 38) { 
		pacman.setDirection(0,-1);
		return false;
    }
    if (e.keyCode == 39) { 
		pacman.setDirection(1,0);
		return false;
    }
    if (e.keyCode == 40) { 
		pacman.setDirection(0,1);
		return false;
    }
});
</script>

</html>
